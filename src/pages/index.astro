---
import Layout from '../components/layout.astro';
---

<style>
  .steps {
    background: var(--light);
    display: grid;
    gap: 2rem;
    grid-template-columns: repeat(5, 100px); /* Adjust based on grid size */
    justify-content: center;
    margin-top: 3rem;
    padding: 5rem 5vw;
    width: 100vw;
  }
  
  .step {
    position: relative;
    width: 100px;
    height: 90px;
    background-color: var(--white);
    border: 1px solid var(--lightBorder);
    border-radius: var(--card-radius);
    margin: auto;
    clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
  }
  
  .step:hover {
    cursor: pointer;
    box-shadow: 0 2px 4px rgb(14 30 37 / 12%);
  }
  </style>

<Layout
  title="City Building Game"
  description="Build and manage your city on a hex grid."
  home
>
  <main class="steps"></main>
</Layout>

<script>
  // Constants
  const GRID_SIZE = 5; // Size of the grid (5x5)
  const HEX_SIZE = 100; // Size of each hex in pixels

  // Game state
  let player = {
    armyLimit: 3,
    currentArmy: 0,
    features: [],
  };

  // Feature types
  const FEATURES = {
    DEFENSIVE: { name: 'Defensive Structure', defenseBonus: 1 },
    ECONOMIC: { name: 'Economic Building', armyLimitIncrease: 1 },
    MILITARY: { name: 'Military Base', armyStrengthBonus: 1, armyLimitDecrease: 1 },
  };

  // Initialize the game board
  function createGameBoard() {
    const gameBoard = document.querySelector('.steps');
    for (let i = 0; i < GRID_SIZE * GRID_SIZE; i++) {
      const hex = document.createElement('div');
      hex.classList.add('step');
      hex.dataset.x = Math.floor(i / GRID_SIZE);
      hex.dataset.y = i % GRID_SIZE;
      hex.addEventListener('click', handleHexClick);
      gameBoard.appendChild(hex);
    }
  }

  // Handle hexagon click
  function handleHexClick(event) {
    const hex = event.target;
    console.log(`Hex clicked at (${hex.dataset.x}, ${hex.dataset.y})`);

    // Example action: build a defensive structure
    buildFeature(hex, 'DEFENSIVE');
  }

  // Function to build a feature on a hex
  function buildFeature(hex, featureType) {
    if (!hex.dataset.feature) {
      hex.dataset.feature = featureType;
      hex.classList.add('feature');
      player.features.push({ type: featureType, position: { x: hex.dataset.x, y: hex.dataset.y } });
      hex.innerHTML = `<p>${FEATURES[featureType].name}</p>`;
    } else {
      alert("Cannot build here.");
    }
  }

  // Start the game
  window.onload = function() {
    createGameBoard();
  };
</script>